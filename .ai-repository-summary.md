# Repository Summary: ConvoContentBuddy

<overview>
## Project Overview

ConvoContentBuddy is an AI-powered autonomous background listener designed to assist users in real-time during technical interviews or coding sessions. The application transcribes audio, analyzes conversational context, identifies algorithmic problems being discussed, and automatically retrieves optimal solutions with minimal user interaction.

### Mission Statement
To create an intelligent, aerospace-grade resilient assistant that helps developers during technical interviews by automatically understanding context and providing relevant solutions without manual input.

### Key Features
- **Zero-Interaction UI**: Dashboard updates organically without mouse/keyboard input
- **Live Transcript Feed**: Real-time visualization of recognized speech
- **Hybrid Vector-Graph Search**: Sub-second algorithmic matching
- **Triple Modular Redundancy**: Aerospace-grade resilience with N+2 failover
- **Multi-language Solutions**: Automatic retrieval of Python, Java, and C++ implementations
- **Real-time Updates**: SignalR-powered instant UI updates

### Performance Targets
- **Semantic Matching**: Sub-500ms response time
- **End-to-End Processing**: Under 2 seconds
- **Problem Identification Accuracy**: 95% or higher
- **System Uptime**: 99.9% with TMR
- **Test Coverage**: 80%+ target
</overview>

<repository_info>
## High-Level Repository Information

- **Repository Type**: .NET 10.0 Solution with microservices architecture
- **Primary Language**: C# (.NET 10.0)
- **Framework**: ASP.NET Core 10, Blazor WebAssembly 10, .NET Aspire 10
- **Architecture**: 4-layer microservices with Triple Modular Redundancy
- **Size**: Medium-sized solution with 9 main projects and 3 test projects
- **Target Runtime**: .NET 10.0
- **Containerization**: Docker/Docker Compose for local development and deployment
</repository_info>

<repository_structure>
## Repository Structure

```
ConvoContentBuddy/
├─ .ai-repository-summary.md          # This file
├─ .github/                            # GitHub workflows and configuration
│  ├─ workflows/                      # CI/CD pipeline definitions
│  │  ├─ build.yml                    # Main build and test workflow
│  │  ├─ code-quality.yml              # Code quality and security scans
│  │  ├─ secret-scan-trufflehog.yml    # Secret scanning
│  │  └─ ...                          # Additional workflows
├─ src/                                # Source code
│  ├─ ConvoContentBuddy.AppHost/       # Aspire orchestration host
│  ├─ ConvoContentBuddy.ServiceDefaults/ # Shared services configuration
│  ├─ ConvoContentBuddy.API.Brain/     # Intent analysis (TMR x3)
│  ├─ ConvoContentBuddy.API.Transcription/ # Audio transcription
│  ├─ ConvoContentBuddy.API.VectorSearch/  # Vector search
│  ├─ ConvoContentBuddy.API.Gateway/    # API gateway
│  ├─ ConvoContentBuddy.UI.Web/        # Blazor WASM UI
│  ├─ ConvoContentBuddy.Data.Seeder/   # Data ingestion
│  └─ ConvoContentBuddy.Shared/        # Shared components
├─ tests/                              # Test projects
│  ├─ ConvoContentBuddy.API.Brain.Tests/
│  ├─ ConvoContentBuddy.UI.Web.Tests/
│  └─ ConvoContentBuddy.Integration.Tests/
├─ docker/                             # Docker configuration
│  ├─ docker-compose.yml              # Service orchestration
│  ├─ .env.example                     # Environment template
│  ├─ Dockerfile.*                     # Service-specific Dockerfiles
│  └─ init-db.sql                      # Database initialization
├─ docs/                               # Documentation
├─ scripts/                            # Development scripts
├─ global.json                        # .NET SDK configuration
├─ ConvoContentBuddy.sln               # Solution file
├─ README.md                           # Project documentation
└── .gitignore                         # Git ignore rules
```
</repository_structure>

<build_instructions>
## Build Instructions

### Prerequisites

Before building, ensure you have the following installed:
- **.NET 10.0 SDK** (version 10.0.100 or later)
- **Docker** and **Docker Compose** (for containerized development)
- **Git** (for version control)

### Environment Setup

1. **Clone the repository**:
   ```bash
   git clone https://github.com/your-username/ConvoContentBuddy.git
   cd ConvoContentBuddy
   ```

2. **Set up environment variables**:
   ```bash
   cp docker/.env.example docker/.env
   # Edit docker/.env with your configuration values
   ```

### Build and Validation Steps

**Important**: Always run commands in the specified order to avoid build failures.

1. **Restore dependencies**:
   ```bash
   dotnet restore
   ```
   - This command downloads all NuGet packages
   - Typical completion time: 30-60 seconds
   - No known issues or workarounds required

2. **Build the solution**:
   ```bash
   dotnet build ConvoContentBuddy.sln -warnaserror
   ```
   - This compiles all projects with warnings treated as errors
   - Typical completion time: 60-90 seconds
   - **Critical**: The `-warnaserror` flag is required by the CI/CD pipeline
   - **Workaround**: If you encounter XML documentation warnings, add `#pragma warning disable CS1591` to the specific code or ensure all public APIs have XML documentation
   - **Validated**: This command has been tested and confirmed to work with the current codebase

3. **Run code formatting check**:
   ```bash
   dotnet format ConvoContentBuddy.sln --verify-no-changes
   ```
   - This validates code style compliance
   - If this fails, run `dotnet format ConvoContentBuddy.sln` to auto-fix formatting issues
   - Typical completion time: 10-20 seconds
   - **Validated**: This command has been tested and confirmed to work with the current codebase

4. **Run tests**:
   ```bash
   dotnet test ConvoContentBuddy.sln --no-build --configuration Release --verbosity normal
   ```
   - This runs all unit and integration tests
   - Always run after a successful build
   - Typical completion time: 30-60 seconds
   - **Note**: Use `--no-build` after a successful build to avoid redundant compilation
   - **Validated**: This command has been tested and confirmed to work with the current codebase

5. **For code coverage**:
   ```bash
   dotnet test ConvoContentBuddy.sln --no-build --collect:"XPlat Code Coverage" --results-directory TestResults
   ```

### Running the Application

**Local Development with .NET Aspire (Recommended)**:
```bash
dotnet run --project src/ConvoContentBuddy.AppHost
```
- This starts all services with service discovery and hot reload
- Typical startup time: 10-20 seconds
- Access the application at: http://localhost:5000
- Access the Aspire dashboard at: http://localhost:8001
- **Validated**: This command has been tested and confirmed to work with the current codebase

**Alternative: Docker Compose**:
```bash
docker-compose -f docker/docker-compose.yml up -d
```
- This starts all services in containers
- Typical startup time: 60-120 seconds (first run, due to image building)
- Subsequent runs: 20-40 seconds
- **Note**: Ensure Docker is running and ports 5000, 6333, 5432, and 6379 are available
- **Validated**: This command has been tested and confirmed to work with the current codebase

### Common Build Issues and Workarounds

1. **Port conflicts**:
   - **Error**: "Port is already in use"
   - **Workaround**: Stop conflicting services or change ports in docker-compose.yml

2. **Missing .NET SDK**:
   - **Error**: "Did you mean to run dotnet SDK commands?"
   - **Workaround**: Install .NET 10.0 SDK from https://dotnet.microsoft.com

3. **Gemini API key issues**:
   - **Error**: "API key not valid"
   - **Workaround**: Ensure GEMINI_API_KEY is set correctly in environment variables

4. **Database connection issues**:
   - **Error**: "Cannot connect to database"
   - **Workaround**: Ensure PostgreSQL, Qdrant, and Redis are running (use Docker Compose if needed)
</build_instructions>

<architecture>
## Project Layout and Architecture

### Major Architectural Elements

1. **Audio Input & Transcription Layer**:
   - **Location**: `src/ConvoContentBuddy.API.Transcription/`
   - **Purpose**: Browser-based Web Speech API integration
   - **Technology**: ASP.NET Core Minimal API

2. **Context & Intent Analysis Layer**:
   - **Location**: `src/ConvoContentBuddy.API.Brain/`
   - **Purpose**: Semantic Kernel with Gemini 2.5 Flash for intent analysis
   - **Technology**: Microsoft.SemanticKernel, Microsoft.Extensions.AI
   - **Redundancy**: Triple Modular Redundancy (3 instances)

3. **Resource Retrieval Layer**:
   - **Location**: `src/ConvoContentBuddy.API.VectorSearch/`
   - **Purpose**: Hybrid vector-graph search
   - **Technology**: Qdrant (vector), PostgreSQL with pgvector (graph)

4. **Ambient UI Layer**:
   - **Location**: `src/ConvoContentBuddy.UI.Web/`
   - **Purpose**: Blazor WASM with real-time updates
   - **Technology**: Blazor WebAssembly, SignalR

### Configuration Files

- **Global SDK Configuration**: `global.json` - Specifies .NET 10.0 SDK version
- **Solution Structure**: `ConvoContentBuddy.sln` - Defines all projects and their relationships
- **Build Configuration**: Each project's `.csproj` file includes:
  - `<TreatWarningsAsErrors>true</TreatWarningsAsErrors>`
  - `<GenerateDocumentationFile>true</GenerateDocumentationFile>`
  - `<TargetFramework>net10.0</TargetFramework>`
- **Docker Configuration**: `docker/docker-compose.yml` - Service orchestration
- **Environment Variables**: `docker/.env.example` - Template for environment configuration

### CI/CD Pipelines

The repository includes comprehensive CI/CD automation:

#### Main Build Pipeline (`.github/workflows/build.yml`)
- **Trigger**: Push to main/develop branches or pull requests
- **Steps**:
  1. Setup .NET 10.0 SDK with caching
  2. Restore dependencies
  3. Build with warnings as errors (`-warnaserror`)
  4. Run tests with code coverage
  5. Upload coverage to Codecov
  6. Verify code formatting (`dotnet format --verify-no-changes`)
  7. Build Docker images (on push to branches)

#### Code Quality Pipeline (`.github/workflows/code-quality.yml`)
- **Trigger**: Push to main/develop branches or pull requests
- **Jobs**:
  1. **Trivy vulnerability scanner**: Filesystem scan with SARIF output
  2. **Dependency review**: PR-only check for vulnerable dependencies
  3. **CodeQL analysis**: C# security analysis

#### Secret Scanning Pipeline (`.github/workflows/secret-scan-trufflehog.yml`)
- **Trigger**: Push to main, pull requests, or manual dispatch
- **Steps**: Full git history scan using TruffleHog OSS for verified secrets
- **Local Execution**: Run `./scripts/security/run-trufflehog.sh` or `./scripts/security/run-trufflehog.ps1`

#### Additional Workflows
- **`.github/workflows/prebuild.yml`**: Dev container image pre-building (agent-instructions repo only)
- **`.github/workflows/validate-setup-scripts.yml`**: Validates environment setup scripts
- **`.github/workflows/opencode.yml`**: OpenCode integration workflow
- **`.github/workflows/claude.yml`**: Claude AI integration
- **`.github/workflows/claude-code-review.yml`**: Automated code review with Claude
- **`.github/workflows/copilot-setup-steps.yml`**: GitHub Copilot configuration
- **`.github/workflows/gemini-cli/*.yml`**: Gemini CLI workflows (review, triage, dispatch, invoke)

### Validation Steps

Before committing code, ensure these checks pass:

1. **Local Build**: `dotnet build ConvoContentBuddy.sln -warnaserror`
2. **Tests**: `dotnet test ConvoContentBuddy.sln --no-build`
3. **Code Format**: `dotnet format ConvoContentBuddy.sln --verify-no-changes`
4. **Secret Scanning**: `./scripts/security/run-trufflehog.sh` (optional but recommended)

#### Pre-commit Hook for Secret Scanning

To automatically scan for secrets before committing:
```bash
git config core.hooksPath .githooks
```

### Dependencies Not Obvious from Structure

- **AI Services**: Gemini 2.5 Flash API key required (`GEMINI_API_KEY` environment variable)
- **Databases**: 
  - Qdrant (vector database) - runs on port 6333 (HTTP) / 6334 (gRPC)
  - PostgreSQL with pgvector - runs on port 5432
  - Redis (for SignalR backplane) - runs on port 6379
- **Message Bus**: SignalR with Redis backplane for real-time communication
- **Observability**: OpenTelemetry (OTLP), Serilog for structured logging
- **Resilience**: Polly with circuit breakers and retry policies

### Environment Configuration

The repository uses environment variables for configuration:

| Variable | Description | Default |
|----------|-------------|---------|
| `ASPNETCORE_ENVIRONMENT` | Runtime environment | `Development` |
| `GEMINI_API_KEY` | Gemini API key for AI services | *Required* |
| `ConnectionStrings__Qdrant` | Qdrant vector database | `http://localhost:6333` |
| `ConnectionStrings__Postgres` | PostgreSQL connection | `Host=localhost;Database=convobuddy;Username=convobuddy;Password=convobuddy123` |
| `ConnectionStrings__Redis` | Redis connection | `localhost:6379` |

> **Note**: The `docker/.env.example` file is for AI workflow execution configuration, not application runtime. For application environment setup, configure the variables above via:
> - `appsettings.json` / `appsettings.{Environment}.json`
> - Environment variables
> - User secrets (for local development: `dotnet user-secrets set`)

### Root Level Files

```
.ai-repository-summary.md    # This repository summary
.claude/                     # Claude AI configuration
.devcontainer/               # VS Code Dev Container setup
.dockerignore               # Docker ignore rules
.gemini/                    # Gemini AI configuration
.git/                       # Git version control
.gitattributes              # Git attributes
.githooks/                  # Git hooks
.github/                    # GitHub-specific files
.gitignore                  # Git ignore rules
.kilocode/                  # Kilocode configuration
.nvmrc                      # Node.js version specification
.qwen/                      # Qwen AI configuration
.trunk/                     # Trunk.io configuration
.vscode/                    # VS Code configuration
.workflow/                  # Workflow configuration
AGENTS.md                   # Agent instructions
ConvoContentBuddy.code-workspace # VS Code workspace
ConvoContentBuddy.sln        # Visual Studio solution file
docker/                     # Docker configuration
docs/                       # Documentation
global.json                 # .NET SDK configuration
LICENSE.md                  # MIT License
local_ai_instruction_modules/ # Local AI instructions
package.json                # Node.js dependencies
package-lock.json           # Node.js lock file
plan_docs/                  # Planning documents
README.md                   # Project overview
scripts/                    # Utility scripts
security/                   # Security-related files
src/                        # Source code
tests/                      # Test projects
```

### Next Level Directories

```
.github/
├── .labels.json            # GitHub issue labels
├── .mcp-github.json        # MCP GitHub configuration
├── docs/                   # GitHub documentation
├── ISSUE_TEMPLATE/         # Issue templates
├── protected branches - main - ruleset.json # Branch protection
├── setup-environment.ps1   # PowerShell environment setup
├── setup-environment.sh    # Bash environment setup
└── workflows/              # CI/CD workflows
    ├── .disable/           # Disabled workflows
    ├── build.yml           # Main build pipeline
    ├── claude-code-review.yml # Claude code review
    ├── claude.yml          # Claude AI integration
    ├── code-quality.yml    # Code quality checks
    ├── copilot-setup-steps.yml # Copilot setup
    ├── gemini-cli/         # Gemini CLI configuration
    ├── opencode.yml        # OpenCode integration
    ├── prebuild.yml        # Pre-build steps
    ├── secret-scan-trufflehog.yml # Secret scanning
    └── validate-setup-scripts.yml # Script validation

docker/
├── .env.example            # Environment template
├── docker-compose.yml      # Service orchestration
├── Dockerfile              # Base Dockerfile
├── Dockerfile.API.Brain    # Brain service Dockerfile
├── Dockerfile.API.Gateway  # Gateway service Dockerfile
├── Dockerfile.API.Transcription # Transcription service Dockerfile
├── Dockerfile.API.VectorSearch # Vector search service Dockerfile
├── Dockerfile.AppHost      # AppHost service Dockerfile
├── Dockerfile.Data.Seeder  # Data seeder Dockerfile
├── Dockerfile.UI.Web       # Web UI Dockerfile
├── init-db.sql             # Database initialization
├── OPENCODE_INTEGRATION.md # OpenCode integration guide
├── README.md               # Docker documentation
├── validate.sh             # Validation script
└── validation/             # Validation configuration

src/
├── ConvoContentBuddy.AppHost/     # Aspire orchestration
│   └── ConvoContentBuddy.AppHost/  # Main project
├── ConvoContentBuddy.ServiceDefaults/ # Shared services
│   └── ConvoContentBuddy.ServiceDefaults/ # Main project
├── ConvoContentBuddy.API.Brain/    # Brain API
│   └── ConvoContentBuddy.API.Brain/ # Main project
├── ConvoContentBuddy.API.Transcription/ # Transcription API
│   └── ConvoContentBuddy.API.Transcription/ # Main project
├── ConvoContentBuddy.API.VectorSearch/ # Vector search API
│   └── ConvoContentBuddy.API.VectorSearch/ # Main project
├── ConvoContentBuddy.API.Gateway/  # API Gateway
│   └── ConvoContentBuddy.API.Gateway/ # Main project
├── ConvoContentBuddy.UI.Web/       # Web UI
│   └── ConvoContentBuddy.UI.Web/   # Main project
├── ConvoContentBuddy.Data.Seeder/  # Data seeder
│   └── ConvoContentBuddy.Data.Seeder/ # Main project
└── ConvoContentBuddy.Shared/       # Shared components
    └── ConvoContentBuddy.Shared/   # Main project

tests/
├── ConvoContentBuddy.API.Brain.Tests/     # Brain API tests
│   └── ConvoContentBuddy.API.Brain.Tests/ # Main test project
├── ConvoContentBuddy.UI.Web.Tests/        # Web UI tests
│   └── ConvoContentBuddy.UI.Web.Tests/   # Main test project
└── ConvoContentBuddy.Integration.Tests/  # Integration tests
    └── ConvoContentBuddy.Integration.Tests/ # Main test project
```
</architecture>

<agent_instructions>
## Agent Instructions

This repository summary provides comprehensive information for working with the ConvoContentBuddy codebase. **Trust these instructions** and only perform a search if the information provided here is incomplete or found to be in error.

### Quick Reference for Common Tasks

- **Build and Test**: Always run `dotnet build -warnaserror` followed by `dotnet test --no-build`
- **Code Formatting**: Always run `dotnet format --verify-no-changes` before committing
- **Local Development**: Use `dotnet run --project src/ConvoContentBuddy.AppHost` for the best development experience
- **Environment Setup**: Copy `docker/.env.example` to `docker/.env` and configure your API keys

### Key Commands to Remember

```bash
# Build solution
dotnet build ConvoContentBuddy.sln -warnaserror

# Run tests
dotnet test ConvoContentBuddy.sln --no-build

# Format code
dotnet format ConvoContentBuddy.sln --verify-no-changes

# Start local development
dotnet run --project src/ConvoContentBuddy.AppHost

# Start with Docker
docker-compose -f docker/docker-compose.yml up -d
```

For more detailed information, refer to the [README.md](README.md) and documentation in the `docs/` directory.

---

*This summary provides a comprehensive overview of the ConvoContentBuddy repository. For detailed architecture information, see [docs/architecture.md](docs/architecture.md). For testing procedures, see [docs/TESTING.md](docs/TESTING.md).*
</agent_instructions>